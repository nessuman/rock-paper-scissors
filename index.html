<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <title>Page Title</title>
  </head>

  <body>
    <script>
      function capitalize(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
      }

      let options = ["rock", "paper", "scissors"];

      function computerPlay() {
        let randomIdx = Math.floor(Math.random()*options.length);
        let computerPick = options[randomIdx];
        return computerPick;
      }

      function playRound(playerSelection, computerSelection) {
        playerSelection = playerSelection.toLowerCase();
        computerSelection = computerSelection.toLowerCase();

        let roundResult;
        let roundResultText;

        switch (playerSelection) {
          case 'rock':
            if (computerSelection === "paper") {
              roundResult = -1;
              roundResultText = "You Lose!";
            } else if (computerSelection === "scissors") {
              roundResult = 1;
              roundResultText = "You Win!";
            } else {
              roundResult = 0;
              roundResultText = "It's a tie!"
            }
            break;
          case 'paper':
            if (computerSelection === "scissors") {
              roundResult = -1;
              roundResultText = "You Lose!";
            } else if (computerSelection === "rock") {
              roundResult = 1;
              roundResultText = "You Win!";
            } else {
              roundResult = 0;
              roundResultText = "It's a tie!"
            }
            break;
          case 'scissors':
            if (computerSelection === "rock") {
              roundResult = -1;
              roundResultText = "You Lose!";
            } else if (computerSelection === "paper") {
              roundResult = 1;
              roundResultText = "You Win!";
            } else {
              roundResult = 0;
              roundResultText = "It's a tie!"
            }
            break;
          default:
            alert("Do you know how to play this game? Try again!");
        }

        if (roundResult != 0) {
          roundResultText = `${roundResultText} ${capitalize(playerSelection)} beats ${capitalize(computerSelection)}`;
        }

        alert(roundResultText);

        return roundResult;

      }

      function game() {
        let winCount = 0;
        let numReps = 5;

        var i = 0;
        while (i < numReps) {
          let playerSelection = prompt("Rock, Paper, Scissors?");
          let computerSelection = computerPlay();

          winCount += playRound(playerSelection, computerSelection);

          i++;
        }

        finalText = `The final score is ${winCount}/${numReps}.`;
        if (winCount >= 3) {
          finalText += `You won!`;
        } else {
          finalText += `You lost!`;
        }
        alert(finalText);
        return winCount;
      }

      console.log(game());
    </script>
  </body>

</html>